import{d as W,l as Z,r as s,c as o,o as n,a as u,u as D,h as ee,w as F,b as r,e,t as p,f as S,F as q,g as te,T as V,i as b,v as y,j as c}from"./app-DjcPY7n4.js";import{_ as ae}from"./AppLayout.vue_vue_type_script_setup_true_lang-BkHQ-Feq.js";import{s as le}from"./default-Dl3m_5ZR.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Dv1fB-vY.js";import"./useForwardExpose-FTsRkq1R.js";import"./VisuallyHidden-tR08VyQk.js";const se={key:0,class:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-6 py-3 rounded shadow-lg"},oe={key:1,class:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-red-500 text-white px-6 py-3 rounded shadow-lg"},ne={key:2,class:"bg-white rounded-xl shadow-md p-6"},de={class:"w-full text-sm text-left text-gray-500"},re={class:"px-6 py-4 flex items-center"},ie={class:"px-6 py-4"},ue={class:"px-6 py-4"},pe={class:"px-6 py-4 flex space-x-2"},ce=["href"],fe=["onClick"],me=["onClick"],xe=["onClick"],ve={key:3,class:"text-gray-500"},he={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},ge={class:"bg-white rounded-lg shadow-lg p-6 max-w-sm w-full"},be={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},ye={class:"bg-white rounded-lg shadow-lg p-6 max-w-sm w-full"},ke={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},we={class:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full"},_e={class:"mb-4"},Ce={class:"flex space-x-2 mb-3"},Me={key:0,class:"mb-3"},Fe={class:"flex justify-end space-x-2"},Pe=W({__name:"Index",props:{folders:{}},setup(I){const L=[{title:"Papkalar",href:"/folders"}];function A(a){if(a===0)return"0 B";const t=["B","KB","MB","GB","TB"],l=Math.floor(Math.log(a)/Math.log(1024));return(a/Math.pow(1024,l)).toFixed(2)+" "+t[l]}const f=I;Z().props.auth.user;const k=s(""),w=s("");function _(a){k.value=a,setTimeout(()=>k.value="",5e3)}function m(a){w.value=a,setTimeout(()=>w.value="",5e3)}const U=s(!1),C=s("");function R(){U.value=!0}function N(){U.value=!1,C.value=""}function X(){c.post("/folders",{name:C.value}).then(a=>{f.folders.data.push(a.data.data),N(),_(a.data.message||"Papka yaratildi!")}).catch(a=>m(a.response?.data?.message||"Xatolik: papka yaratilmagan!"))}function G(a){c.delete(`/folders/${a}`,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}}).then(()=>window.location.reload()).catch(()=>alert("Papka o'chirishda xato yuz berdi."))}function K(a){confirm("Papkani o‘chirishga ishonchingiz komilmi?")&&G(a)}const z=s(!1),i=s(""),x=s(null);function Y(a){i.value=a.name,x.value=a.id,z.value=!0}function P(){z.value=!1,i.value="",x.value=null}function J(){x.value&&c.put(`/folders/${x.value}`,{name:i.value}).then(a=>{const t=f.folders.data.findIndex(l=>l.id===x.value);t!==-1&&(f.folders.data[t].name=i.value),P(),_(a.data.message||"Papka nomi o‘zgartirildi!")}).catch(a=>m(a.response?.data?.message||"Xatolik: papka nomi o‘zgartirilmadi!"))}const B=s(!1),v=s(null),T=s(""),h=s(""),g=s(""),d=s(""),$=s([]),M=s([]);function O(a){v.value=a.id,T.value=a.name,B.value=!0,d.value="",h.value="",g.value="",M.value=[],c.get("/users").then(t=>{$.value=t.data.data}).catch(()=>m("Userlarni olishda xato!"))}function j(){B.value=!1}function H(){v.value&&c.post(`/shareble/${v.value}/share`,{type:"folder",expires_at:h.value||null,password:g.value||null}).then(a=>{d.value=a.data.url,_("Share link yaratildi!")}).catch(()=>m("Share link yaratishda xato!"))}function Q(){v.value&&c.post(`/shareble/${v.value}/share/send`,{password:g.value,expires_at:h.value,type:"folder",url:d.value,users:M.value}).then(a=>{_(a.data.message||"Link yuborildi!"),j()}).catch(()=>m("Userlarga yuborishda xato!"))}return(a,t)=>(n(),o(q,null,[u(D(ee),{title:"Folders"}),u(ae,{breadcrumbs:L},{default:F(()=>[k.value?(n(),o("div",se,p(k.value),1)):r("",!0),w.value?(n(),o("div",oe,p(w.value),1)):r("",!0),e("div",{class:"mb-4"},[e("button",{onClick:R,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center"},t[6]||(t[6]=[e("i",{class:"fas fa-plus mr-2"},null,-1),S(" New Folder ",-1)]))]),f.folders.data.length?(n(),o("div",ne,[e("table",de,[t[13]||(t[13]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-100"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Name"),e("th",{class:"px-6 py-3"},"Date Modified"),e("th",{class:"px-6 py-3"},"Type"),e("th",{class:"px-6 py-3"},"Size"),e("th",{class:"px-6 py-3"},"Actions")])],-1)),e("tbody",null,[(n(!0),o(q,null,te(f.folders.data,l=>(n(),o("tr",{key:l.id,class:"hover:bg-gray-50"},[e("td",re,[t[7]||(t[7]=e("i",{class:"fas fa-folder text-yellow-500 mr-2"},null,-1)),S(p(l.name),1)]),e("td",ie,p(new Date(l.created_at).toLocaleDateString()),1),t[12]||(t[12]=e("td",{class:"px-6 py-4"},"Folder",-1)),e("td",ue,p(A(l.size)),1),e("td",pe,[e("a",{href:a.route("folders.show",l.id),class:"text-blue-500 hover:text-blue-700"},t[8]||(t[8]=[e("i",{class:"fas fa-folder-open"},null,-1)]),8,ce),e("button",{onClick:E=>O(l),class:"text-green-500 hover:text-green-700"},t[9]||(t[9]=[e("i",{class:"fas fa-share-alt"},null,-1)]),8,fe),e("button",{onClick:E=>K(l.id),class:"text-red-500 hover:text-red-700"},t[10]||(t[10]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,me),e("button",{onClick:E=>Y(l),class:"text-yellow-500 hover:text-yellow-700"},t[11]||(t[11]=[e("i",{class:"fas fa-edit"},null,-1)]),8,xe)])]))),128))])])])):(n(),o("p",ve,"No folders found.")),u(V,{name:"modal"},{default:F(()=>[U.value?(n(),o("div",he,[e("div",ge,[t[14]||(t[14]=e("h2",{class:"text-lg font-semibold mb-4"},"Yangi papka yaratish",-1)),b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>C.value=l),type:"text",placeholder:"Enter folder name",class:"border rounded px-3 py-2 w-full mb-4"},null,512),[[y,C.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:N,class:"px-4 py-2 bg-gray-200 rounded"},"Bekor qilish"),e("button",{onClick:X,class:"px-4 py-2 bg-blue-500 text-white rounded"},"Saqlash")])])])):r("",!0)]),_:1}),u(V,{name:"modal"},{default:F(()=>[z.value?(n(),o("div",be,[e("div",ye,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold mb-4"},"Papka nomini o‘zgartirish",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>i.value=l),type:"text",placeholder:"Enter new folder name",class:"border rounded px-3 py-2 w-full mb-4"},null,512),[[y,i.value]]),e("div",{class:"flex justify-end space-x-2"},[e("button",{onClick:P,class:"px-4 py-2 bg-gray-200 rounded"},"Bekor qilish"),e("button",{onClick:J,class:"px-4 py-2 bg-blue-500 text-white rounded"},"Yangilash")])])])):r("",!0)]),_:1}),u(V,{name:"modal"},{default:F(()=>[B.value?(n(),o("div",ke,[e("div",we,[t[18]||(t[18]=e("h2",{class:"text-lg font-semibold mb-4"},"Papkani ulash",-1)),e("p",_e,[t[16]||(t[16]=e("strong",null,"Papka nomi:",-1)),S(" "+p(T.value),1)]),b(e("input",{type:"datetime-local","onUpdate:modelValue":t[2]||(t[2]=l=>h.value=l),class:"border rounded px-3 py-2 w-full mb-3"},null,512),[[y,h.value]]),b(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=l=>g.value=l),placeholder:"Parol (ixtiyoriy)",class:"border rounded px-3 py-2 w-full mb-3"},null,512),[[y,g.value]]),e("div",Ce,[e("button",{onClick:H,class:"px-4 py-2 bg-blue-500 text-white rounded"},"Generate URL"),d.value?b((n(),o("input",{key:0,"onUpdate:modelValue":t[4]||(t[4]=l=>d.value=l),readonly:"",class:"border px-3 py-2 rounded w-full"},null,512)),[[y,d.value]]):r("",!0)]),d.value?(n(),o("div",Me,[t[17]||(t[17]=e("label",{class:"block text-sm mb-1"},"Select Users",-1)),u(D(le),{modelValue:M.value,"onUpdate:modelValue":t[5]||(t[5]=l=>M.value=l),options:$.value,mode:"tags",label:"name","track-by":"id","value-prop":"id",placeholder:"Foydalanuvchilarni tanlang"},null,8,["modelValue","options"])])):r("",!0),e("div",Fe,[e("button",{onClick:j,class:"px-4 py-2 bg-gray-200 rounded"},"Bekor qilish"),d.value?(n(),o("button",{key:0,onClick:Q,class:"px-4 py-2 bg-green-500 text-white rounded"},"Jo‘natish")):r("",!0)])])])):r("",!0)]),_:1})]),_:1})],64))}});export{Pe as default};
