import{d as j,r as l,c as o,o as r,a as h,u as k,h as B,w as A,e,f as U,b as d,F as C,g as K,t as i,T as L,i as y,v as b,j as v}from"./app-CvWSRHXZ.js";import{_ as M}from"./AppLayout.vue_vue_type_script_setup_true_lang-ukFRSCtx.js";import{s as z}from"./default-CSfWLQJq.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Cy0htrRV.js";import"./useForwardExpose-CtqrSHKd.js";import"./VisuallyHidden-Cvv-R-Bg.js";const E={class:"container mx-auto px-4 py-8 max-w-6xl"},q={class:"bg-white rounded-xl shadow-md overflow-hidden"},I={class:"p-6"},O={class:"relative overflow-x-auto responsive-table"},P={class:"w-full text-sm text-left text-gray-500"},R={class:"px-6 py-4"},Y={class:"px-6 py-4"},G={class:"px-6 py-4"},J={class:"px-6 py-4"},X={class:"px-6 py-4"},H={class:"px-6 py-4"},Q={class:"px-6 py-4 flex space-x-2"},W=["href"],Z=["onClick"],ee=["href"],te=["onClick"],se={key:0,class:"text-gray-500 text-center py-8"},ae={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},le={class:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full"},oe={class:"mb-4"},re={class:"flex space-x-2 mb-3"},ne={key:0,class:"mb-3"},ie={class:"flex justify-end space-x-2"},ve=j({__name:"Index",props:{archives:{}},setup(V){const m=V;l(m.archives);function S(a){v.delete(`/archives/${a}`,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}}).then(()=>window.location.reload()).catch(t=>{console.error("Arxiv o'chirishda xato:",t),alert("Arxiv o'chirishda xato yuz berdi.")})}function N(a){confirm("Arxivni o‘chirishga ishonchingiz komilmi?")&&S(a)}const f=l(!1),u=l(null),g=l(""),c=l(""),p=l(""),n=l(""),_=l([]),x=l([]);function $(a){u.value=a.id,g.value=a.name,f.value=!0,n.value="",c.value="",p.value="",x.value=[],v.get("/users").then(t=>{_.value=t.data.data}).catch(()=>alert("Userlarni olishda xato!"))}function w(){f.value=!1}function T(){u.value&&v.post(`/shareble/${u.value}/share`,{type:"archive",expires_at:c.value||null,password:p.value||null}).then(a=>{n.value=a.data.url,alert("Share link yaratildi!")}).catch(()=>alert("Share link yaratishda xato!"))}function D(){u.value&&v.post(`/shareble/${u.value}/share/send`,{expires_at:c.value,type:"archive",url:n.value,users:x.value,password:p.value}).then(a=>{alert(a.data.message||"Link yuborildi!"),w()}).catch(()=>alert("Userlarga yuborishda xato!"))}return(a,t)=>(r(),o(C,null,[h(k(B),{title:"Arxivlar"}),h(M,null,{default:A(()=>[e("div",E,[t[9]||(t[9]=e("div",{class:"flex justify-between items-center mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Arxivlar ro‘yxati"),e("a",{href:"/archives/create",class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center transition-colors"},[e("i",{class:"fas fa-plus mr-2"}),U(" Yangi arxiv ")])],-1)),e("div",q,[e("div",I,[e("div",O,[e("table",P,[t[8]||(t[8]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-100"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Nomi"),e("th",{class:"px-6 py-3"},"Kod"),e("th",{class:"px-6 py-3"},"Kategoriya"),e("th",{class:"px-6 py-3"},"Papka"),e("th",{class:"px-6 py-3"},"Foydalanuvchi"),e("th",{class:"px-6 py-3"},"Yaratilgan sana"),e("th",{class:"px-6 py-3"},"Amallar")])],-1)),e("tbody",null,[(r(!0),o(C,null,K(m.archives,s=>(r(),o("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[e("td",R,i(s.name.substring(0,50)),1),e("td",Y,i(s.code),1),e("td",G,i(s.category?.name||"-"),1),e("td",J,i(s.folder?.name||"-"),1),e("td",X,i(s.user?.name||"-"),1),e("td",H,i(new Date(s.created_at).toLocaleDateString()),1),e("td",Q,[s.file?(r(),o("a",{key:0,href:`/storage/${s.file?.path}`,class:"text-blue-500 hover:text-blue-700",title:"Ko‘rish",target:"_blank"},t[4]||(t[4]=[e("i",{class:"fas fa-eye"},null,-1)]),8,W)):d("",!0),e("button",{class:"text-green-500 hover:text-green-700",onClick:F=>$(s),title:"Ulashish"},t[5]||(t[5]=[e("i",{class:"fas fa-share-alt"},null,-1)]),8,Z),e("a",{href:a.route("archives.edit",s.id),class:"text-yellow-500 hover:text-yellow-700",title:"Edit"},t[6]||(t[6]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ee),e("button",{class:"text-red-500 hover:text-red-700",onClick:F=>N(s.id),title:"O‘chirish"},t[7]||(t[7]=[e("i",{class:"fas fa-trash"},null,-1)]),8,te)])]))),128))])]),m.archives.length===0?(r(),o("div",se," Arxivlar topilmadi. ")):d("",!0)])])])]),h(L,{name:"modal"},{default:A(()=>[f.value?(r(),o("div",ae,[e("div",le,[t[12]||(t[12]=e("h2",{class:"text-lg font-semibold mb-4"},"Arxivni ulash",-1)),e("p",oe,[t[10]||(t[10]=e("strong",null,"Arxiv nomi:",-1)),U(" "+i(g.value),1)]),y(e("input",{type:"datetime-local","onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),class:"border rounded px-3 py-2 w-full mb-3"},null,512),[[b,c.value]]),y(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),placeholder:"Parol (ixtiyoriy)",class:"border rounded px-3 py-2 w-full mb-3"},null,512),[[b,p.value]]),e("div",re,[e("button",{onClick:T,class:"px-4 py-2 bg-blue-500 text-white rounded"},"Generate URL"),n.value?y((r(),o("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=s=>n.value=s),readonly:"",class:"border px-3 py-2 rounded w-full"},null,512)),[[b,n.value]]):d("",!0)]),n.value?(r(),o("div",ne,[t[11]||(t[11]=e("label",{class:"block text-sm mb-1"},"Select Users",-1)),h(k(z),{modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=s=>x.value=s),options:_.value,mode:"tags",label:"name","track-by":"id","value-prop":"id",placeholder:"Foydalanuvchilarni tanlang"},null,8,["modelValue","options"])])):d("",!0),e("div",ie,[e("button",{onClick:w,class:"px-4 py-2 bg-gray-200 rounded"},"Bekor qilish"),n.value?(r(),o("button",{key:0,onClick:D,class:"px-4 py-2 bg-green-500 text-white rounded"},"Jo‘natish")):d("",!0)])])])):d("",!0)]),_:1})]),_:1})],64))}});export{ve as default};
