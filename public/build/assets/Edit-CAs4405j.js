import{d as z,r as d,c as l,o,a as _,u as N,h as A,w as D,b as w,e as t,n as p,t as n,i as V,v as j,f as u,F as y,g as k,k as $}from"./app-t1hFasqC.js";import{_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-DRGrYa5k.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-WQcd9ENm.js";import"./useForwardExpose-BiSBS3b4.js";import"./VisuallyHidden-DLgn2Ija.js";const U={class:"container mx-auto px-4 py-8 max-w-4xl"},P={class:"bg-white rounded-xl shadow-md overflow-hidden p-6"},R={class:"mb-6"},q={class:"mb-8"},G={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"},K=["onClick"],L={class:"mb-8"},H={class:"flex flex-wrap gap-3"},J=["onClick"],O={class:"mb-6"},Q={key:0,class:"flex items-center justify-between p-2 bg-gray-50 rounded"},W={class:"flex items-center"},X={class:"font-medium text-gray-800"},Y={class:"text-xs text-gray-500"},Z={key:1,class:"text-gray-500"},ee={class:"mb-6"},te={class:"file-drop-area p-8 text-center"},se={class:"flex flex-col items-center justify-center"},ie={key:0,class:"mt-4"},le={class:"flex items-center justify-between p-2 bg-gray-50 rounded"},oe={class:"flex items-center"},re={class:"font-medium text-gray-800"},ae={class:"text-xs text-gray-500"},ne=z({__name:"Edit",props:{archive:{},folders:{},categories:{}},setup(F){const r=F,f=d(r.folders.find(s=>s.id===r.archive.folder_id)||null),c=d(r.archive.category_id),m=d(r.archive.name),a=d([]),x=d(""),b=d(!1);function v(s,e=!1){x.value=s,b.value=e,setTimeout(()=>x.value="",5e3)}function C(s){const e=s.target.files;if(e&&e[0]){const i=e[0];if(i.size>20*1024*1024){alert("Fayl hajmi 20 MB dan oshmasligi kerak!");return}a.value=[i]}}function B(){a.value=[]}function M(s){f.value=s}function S(s){c.value=s.id}function h(s){if(s===0)return"0 Bytes";const e=1024,i=["Bytes","KB","MB","GB"],g=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,g)).toFixed(2))+" "+i[g]}async function E(){if(!f.value){alert("Please select a folder");return}if(!c.value){alert("Please select a category");return}if(!m.value.trim()){alert("Archive name required");return}const s=new FormData;s.append("folder_id",f.value.id.toString()),s.append("category_id",c.value.toString()),s.append("name",m.value),a.value.length>0&&s.append("file",a.value[0]);try{await $.post(`/archives/${r.archive.id}`,s,{forceFormData:!0,onSuccess:()=>{v("Archive updated successfully!",!1)},onError:e=>{console.error("Validation errors:",e),v("Failed to update archive. Check inputs.",!0)}})}catch(e){console.error("Unexpected error:",e),v("Unexpected error occurred.",!0)}}return(s,e)=>(o(),l(y,null,[_(N(A),{title:"Arxivni tahrirlash"}),_(I,null,{default:D(()=>[x.value?(o(),l("div",{key:0,class:p(["fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded shadow-lg z-50 transition",b.value?"bg-red-500 text-white":"bg-green-500 text-white"])},n(x.value),3)):w("",!0),t("div",U,[t("div",P,[e[17]||(e[17]=t("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"Edit Archive",-1)),e[18]||(e[18]=t("p",{class:"text-gray-600 mb-6"},"Change archive info, folder, category or files",-1)),t("div",R,[e[1]||(e[1]=t("label",{class:"block text-gray-700 mb-2"},"Archive Name",-1)),V(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>m.value=i),type:"text",class:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[j,m.value]])]),t("div",q,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-folder-open mr-2 text-indigo-500"}),u(" Select Folder ")],-1)),t("div",G,[(o(!0),l(y,null,k(s.folders,i=>(o(),l("div",{key:i.id,class:p(["folder-item cursor-pointer p-3 border rounded-lg flex items-center",{"border-indigo-500 bg-indigo-50":f.value?.id===i.id}]),onClick:g=>M(i)},[e[2]||(e[2]=t("i",{class:"fas fa-folder mr-3 text-xl text-yellow-500"},null,-1)),t("span",null,n(i.name),1)],10,K))),128))])]),t("div",L,[e[5]||(e[5]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-tags mr-2 text-indigo-500"}),u(" Select Category ")],-1)),t("div",H,[(o(!0),l(y,null,k(s.categories,i=>(o(),l("div",{key:i.id,class:p(["category-pill cursor-pointer px-4 py-2 bg-gray-100 rounded-full flex items-center",{"bg-indigo-100 border border-indigo-300":c.value===i.id}]),onClick:g=>S(i)},[e[4]||(e[4]=t("i",{class:"fas fa-tag mr-2 text-gray-500"},null,-1)),t("span",null,n(i.name),1)],10,J))),128))])]),t("div",O,[e[7]||(e[7]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-file mr-2 text-indigo-500"}),u(" Existing File ")],-1)),r.archive.file?(o(),l("div",Q,[t("div",W,[e[6]||(e[6]=t("i",{class:"fas fa-file text-indigo-500 mr-3"},null,-1)),t("div",null,[t("div",X,n(r.archive.file.name),1),t("div",Y,n(h(r.archive.file.size)),1)])])])):(o(),l("div",Z,"No file uploaded."))]),t("div",ee,[e[15]||(e[15]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-cloud-upload-alt mr-2 text-indigo-500"}),u(" Replace/Add File ")],-1)),t("div",te,[t("div",se,[e[8]||(e[8]=t("i",{class:"fas fa-cloud-upload-alt text-5xl text-indigo-400 mb-4"},null,-1)),e[9]||(e[9]=t("p",{class:"text-gray-600 mb-2"},"Drag & drop a new file here",-1)),e[10]||(e[10]=t("p",{class:"text-gray-500 text-sm mb-4"},"or",-1)),e[11]||(e[11]=t("label",{for:"fileInput",class:"cursor-pointer px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition"}," Browse File ",-1)),t("input",{type:"file",id:"fileInput",class:"hidden",onChange:C},null,32)])]),a.value.length>0?(o(),l("div",ie,[e[14]||(e[14]=t("h3",{class:"font-medium text-gray-700 mb-2"},"Selected File:",-1)),t("div",le,[t("div",oe,[e[12]||(e[12]=t("i",{class:"fas fa-file text-indigo-500 mr-3"},null,-1)),t("div",null,[t("div",re,n(a.value[0].name),1),t("div",ae,n(h(a.value[0].size)),1)])]),t("button",{onClick:B,type:"button",class:"text-red-500 hover:text-red-700"},e[13]||(e[13]=[t("i",{class:"fas fa-times"},null,-1)]))])])):w("",!0)]),t("div",{class:"mt-4 flex justify-end"},[t("button",{type:"button",onClick:E,class:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition flex items-center"},e[16]||(e[16]=[t("i",{class:"fas fa-save mr-2"},null,-1),u(" Save Changes ",-1)]))])])])]),_:1})],64))}}),ge=T(ne,[["__scopeId","data-v-4581add9"]]);export{ge as default};
