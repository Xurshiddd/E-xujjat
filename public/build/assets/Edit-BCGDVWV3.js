import{d as E,r as n,c as a,o as i,a as h,u as N,h as j,w as T,b as w,e as t,n as v,t as d,i as V,v as A,f as g,F as y,g as _,j as D}from"./app-gy54rHtg.js";import{_ as U}from"./AppLayout.vue_vue_type_script_setup_true_lang-Bt8l3c-R.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Db-UikCm.js";import"./useForwardExpose-86WOPWNI.js";import"./VisuallyHidden-C-pa06ho.js";const I={class:"container mx-auto px-4 py-8 max-w-4xl"},P={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden p-6"},R={class:"mb-6"},G={class:"mb-8"},K={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"},L=["onClick"],q={class:"mb-8"},H={class:"flex flex-wrap gap-3"},J=["onClick"],O={class:"mb-6"},Q={key:0,class:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded"},W={class:"flex items-center"},X={class:"font-medium text-gray-800 dark:text-gray-100"},Y={class:"text-xs text-gray-500 dark:text-gray-300"},Z={key:1,class:"text-gray-500 dark:text-gray-400"},ee={class:"mb-6"},te={class:"file-drop-area p-8 text-center bg-white dark:bg-gray-700 dark:border-gray-600 rounded"},se={class:"flex flex-col items-center justify-center"},re={key:0,class:"mt-4"},ae={class:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded"},ie={class:"flex items-center"},oe={class:"font-medium text-gray-800 dark:text-gray-100"},le={class:"text-xs text-gray-500 dark:text-gray-300"},de=E({__name:"Edit",props:{archive:{},folders:{},categories:{}},setup(C){const o=C,u=n(o.folders.find(s=>s.id===o.archive.folder_id)||null),f=n(o.archive.category_id),m=n(o.archive.name),l=n([]),c=n(""),b=n(!1);function p(s,e=!1){c.value=s,b.value=e,setTimeout(()=>c.value="",5e3)}function F(s){const e=s.target.files;if(e&&e[0]){const r=e[0];if(r.size>20*1024*1024){alert("Fayl hajmi 20 MB dan oshmasligi kerak!");return}l.value=[r]}}function B(){l.value=[]}function M(s){u.value=s}function S(s){f.value=s.id}function k(s){if(s===0)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB"],x=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,x)).toFixed(2))+" "+r[x]}async function z(){if(!u.value){alert("Please select a folder");return}if(!f.value){alert("Please select a category");return}const s=new FormData;s.append("folder_id",u.value.id.toString()),s.append("category_id",f.value.toString()),s.append("name",m.value),s.append("_method","PUT"),l.value.length>0&&s.append("file",l.value[0]);try{const e=await D.post(`/archives/${o.archive.id}`,s,{headers:{"Content-Type":"multipart/form-data"}});p("Archive updated successfully!",!1),setTimeout(()=>{window.location.reload()},3e3)}catch(e){e.response&&e.response.status===422?(console.error("Validation errors:",e.response.data.errors),p("Failed to update archive. Check inputs.",!0)):(console.error("Unexpected error:",e),p("Unexpected error occurred.",!0))}}return(s,e)=>(i(),a(y,null,[h(N(j),{title:"Arxivni tahrirlash"}),h(U,null,{default:T(()=>[c.value?(i(),a("div",{key:0,class:v(["fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded shadow-lg z-50 transition",b.value?"bg-red-500 text-white dark:bg-red-600":"bg-green-500 text-white dark:bg-green-600"])},d(c.value),3)):w("",!0),t("div",I,[t("div",P,[e[17]||(e[17]=t("h1",{class:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2"},"Edit Archive",-1)),e[18]||(e[18]=t("p",{class:"text-gray-600 dark:text-gray-300 mb-6"}," Change archive info, folder, category or files ",-1)),t("div",R,[e[1]||(e[1]=t("label",{class:"block text-gray-700 dark:text-gray-300 mb-2"},"Archive Name",-1)),V(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>m.value=r),type:"text",class:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600"},null,512),[[A,m.value]])]),t("div",G,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold text-gray-700 dark:text-gray-200 mb-4 flex items-center"},[t("i",{class:"fas fa-folder-open mr-2 text-indigo-500"}),g(" Select Folder ")],-1)),t("div",K,[(i(!0),a(y,null,_(s.folders,r=>(i(),a("div",{key:r.id,class:v(["folder-item cursor-pointer p-3 border rounded-lg flex items-center bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",{"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/40":u.value?.id===r.id}]),onClick:x=>M(r)},[e[2]||(e[2]=t("i",{class:"fas fa-folder mr-3 text-xl text-yellow-500"},null,-1)),t("span",null,d(r.name),1)],10,L))),128))])]),t("div",q,[e[5]||(e[5]=t("h2",{class:"text-xl font-semibold text-gray-700 dark:text-gray-200 mb-4 flex items-center"},[t("i",{class:"fas fa-tags mr-2 text-indigo-500"}),g(" Select Category ")],-1)),t("div",H,[(i(!0),a(y,null,_(s.categories,r=>(i(),a("div",{key:r.id,class:v(["category-pill cursor-pointer px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center text-gray-700 dark:text-gray-200",{"bg-indigo-100 border border-indigo-300 dark:bg-indigo-900/40 dark:border-indigo-600":f.value===r.id}]),onClick:x=>S(r)},[e[4]||(e[4]=t("i",{class:"fas fa-tag mr-2 text-gray-500 dark:text-gray-300"},null,-1)),t("span",null,d(r.name),1)],10,J))),128))])]),t("div",O,[e[7]||(e[7]=t("h2",{class:"text-xl font-semibold text-gray-700 dark:text-gray-200 mb-4 flex items-center"},[t("i",{class:"fas fa-file mr-2 text-indigo-500"}),g(" Existing File ")],-1)),o.archive.file?(i(),a("div",Q,[t("div",W,[e[6]||(e[6]=t("i",{class:"fas fa-file text-indigo-500 mr-3"},null,-1)),t("div",null,[t("div",X,d(o.archive.name),1),t("div",Y,d(k(o.archive.file.size)),1)])])])):(i(),a("div",Z,"No file uploaded."))]),t("div",ee,[e[15]||(e[15]=t("h2",{class:"text-xl font-semibold text-gray-700 dark:text-gray-200 mb-4 flex items-center"},[t("i",{class:"fas fa-cloud-upload-alt mr-2 text-indigo-500"}),g(" Replace/Add File ")],-1)),t("div",te,[t("div",se,[e[8]||(e[8]=t("i",{class:"fas fa-cloud-upload-alt text-5xl text-indigo-400 mb-4"},null,-1)),e[9]||(e[9]=t("p",{class:"text-gray-600 dark:text-gray-300 mb-2"},"Drag & drop a new file here",-1)),e[10]||(e[10]=t("p",{class:"text-gray-500 dark:text-gray-400 text-sm mb-4"},"or",-1)),e[11]||(e[11]=t("label",{for:"fileInput",class:"cursor-pointer px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition"}," Browse File ",-1)),t("input",{type:"file",id:"fileInput",class:"hidden",onChange:F},null,32)])]),l.value.length>0?(i(),a("div",re,[e[14]||(e[14]=t("h3",{class:"font-medium text-gray-700 dark:text-gray-200 mb-2"},"Selected File:",-1)),t("div",ae,[t("div",ie,[e[12]||(e[12]=t("i",{class:"fas fa-file text-indigo-500 mr-3"},null,-1)),t("div",null,[t("div",oe,d(l.value[0].name),1),t("div",le,d(k(l.value[0].size)),1)])]),t("button",{onClick:B,type:"button",class:"text-red-500 hover:text-red-700 dark:hover:text-red-400"},e[13]||(e[13]=[t("i",{class:"fas fa-times"},null,-1)]))])])):w("",!0)]),t("div",{class:"mt-4 flex justify-end"},[t("button",{type:"button",onClick:z,class:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition flex items-center"},e[16]||(e[16]=[t("i",{class:"fas fa-save mr-2"},null,-1),g(" Save Changes ",-1)]))])])])]),_:1})],64))}}),me=$(de,[["__scopeId","data-v-7b312c16"]]);export{me as default};
