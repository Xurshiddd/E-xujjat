import{d as K,r,c as l,o,a as g,b as w,h as L,w as A,e,i as U,f as n,F as C,g as M,t as i,T as P,m as b,v as f,q as y}from"./app-ZGqOI-tJ.js";import{_ as j}from"./AppLayout.vue_vue_type_script_setup_true_lang-DyFhYf80.js";import{s as q}from"./default-CcLKMXDe.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CFHTb6Ft.js";import"./useForwardExpose-zIGDmqh7.js";import"./VisuallyHidden-C4RpEk8n.js";const z={class:"px-4 py-8"},E={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden"},I={class:"p-6"},O={class:"relative overflow-x-auto responsive-table"},R={class:"w-full text-sm text-left text-gray-600 dark:text-gray-300"},Y={class:"px-6 py-4"},G={class:"px-6 py-4"},J={class:"px-6 py-4"},X={class:"px-6 py-4"},H={class:"px-6 py-4"},Q={class:"px-6 py-4"},W={class:"px-6 py-4 flex space-x-2"},Z=["href"],ee=["onClick"],te=["href"],ae=["onClick"],se={key:0,class:"text-gray-500 dark:text-gray-400 text-center py-8"},re={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},le={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-md w-full"},oe={class:"mb-4 text-gray-700 dark:text-gray-300"},de={class:"flex space-x-2 mb-3"},ie={key:0,class:"mb-3"},ne={class:"flex justify-end space-x-2"},he=K({__name:"Index",props:{archives:{}},setup(V){const S=[{title:"Papkalar",href:"/folders"},{title:"Papka",href:"/folders/{id}"}],h=V;r(h.archives);function N(s){y.delete(`/archives/${s}`,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}}).then(()=>window.location.reload()).catch(t=>{console.error("Arxiv o'chirishda xato:",t),alert("Arxiv o'chirishda xato yuz berdi.")})}function $(s){confirm("Arxivni o‘chirishga ishonchingiz komilmi?")&&N(s)}const v=r(!1),u=r(null),m=r(""),x=r(""),c=r(""),d=r(""),k=r([]),p=r([]);function T(s){u.value=s.id,m.value=s.name,v.value=!0,d.value="",x.value="",c.value="",p.value=[],y.get("/users").then(t=>{k.value=t.data.data}).catch(()=>alert("Userlarni olishda xato!"))}function _(){v.value=!1}function D(){u.value&&y.post(`/shareble/${u.value}/share`,{type:"archive",expires_at:x.value||null,password:c.value||null}).then(s=>{d.value=s.data.url,alert("Share link yaratildi!")}).catch(()=>alert("Share link yaratishda xato!"))}function F(){u.value&&y.post(`/shareble/${u.value}/share/send`,{expires_at:x.value,type:"archive",url:d.value,users:p.value,password:c.value}).then(s=>{alert(s.data.message||"Link yuborildi!"),_()}).catch(()=>alert("Userlarga yuborishda xato!"))}return(s,t)=>(o(),l(C,null,[g(w(L),{title:"Arxivlar"}),g(j,{breadcrumbs:S},{default:A(()=>[e("div",z,[t[9]||(t[9]=e("div",{class:"flex justify-between items-center mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Arxivlar ro‘yxati"),e("a",{href:"/archives/create",class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center transition-colors"},[e("i",{class:"fas fa-plus mr-2"}),U(" Yangi arxiv ")])],-1)),e("div",E,[e("div",I,[e("div",O,[e("table",R,[t[8]||(t[8]=e("thead",{class:"text-xs text-gray-700 dark:text-gray-200 uppercase bg-gray-100 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Nomi"),e("th",{class:"px-6 py-3"},"Kod"),e("th",{class:"px-6 py-3"},"Kategoriya"),e("th",{class:"px-6 py-3"},"Papka"),e("th",{class:"px-6 py-3"},"Foydalanuvchi"),e("th",{class:"px-6 py-3"},"Yaratilgan sana"),e("th",{class:"px-6 py-3"},"Amallar")])],-1)),e("tbody",null,[(o(!0),l(C,null,M(h.archives,a=>(o(),l("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[e("td",Y,i(a.name.substring(0,50)),1),e("td",G,i(a.code),1),e("td",J,i(a.category?.name||"-"),1),e("td",X,i(a.folder?.name||"-"),1),e("td",H,i(a.user?.name||"-"),1),e("td",Q,i(new Date(a.created_at).toLocaleDateString()),1),e("td",W,[a.file?(o(),l("a",{key:0,href:`/storage/${a.file?.path}`,class:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",title:"Ko‘rish",target:"_blank"},t[4]||(t[4]=[e("i",{class:"fas fa-eye"},null,-1)]),8,Z)):n("",!0),e("button",{class:"text-green-500 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",onClick:B=>T(a),title:"Ulashish"},t[5]||(t[5]=[e("i",{class:"fas fa-share-alt"},null,-1)]),8,ee),e("a",{href:s.route("archives.edit",a.id),class:"text-yellow-500 hover:text-yellow-700 dark:text-yellow-400 dark:hover:text-yellow-300",title:"Edit"},t[6]||(t[6]=[e("i",{class:"fas fa-edit"},null,-1)]),8,te),e("button",{class:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",onClick:B=>$(a.id),title:"O‘chirish"},t[7]||(t[7]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ae)])]))),128))])]),h.archives.length===0?(o(),l("div",se," Arxivlar topilmadi. ")):n("",!0)])])])]),g(P,{name:"modal"},{default:A(()=>[v.value?(o(),l("div",re,[e("div",le,[t[12]||(t[12]=e("h2",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-gray-100"},"Arxivni ulash",-1)),e("p",oe,[t[10]||(t[10]=e("strong",null,"Arxiv nomi:",-1)),U(" "+i(m.value),1)]),b(e("input",{type:"datetime-local","onUpdate:modelValue":t[0]||(t[0]=a=>x.value=a),class:"border dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded px-3 py-2 w-full mb-3"},null,512),[[f,x.value]]),b(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>c.value=a),placeholder:"Parol (ixtiyoriy)",class:"border dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 rounded px-3 py-2 w-full mb-3"},null,512),[[f,c.value]]),e("div",de,[e("button",{onClick:D,class:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded"}," Generate URL "),d.value?b((o(),l("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value=a),readonly:"",class:"border dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 px-3 py-2 rounded w-full"},null,512)),[[f,d.value]]):n("",!0)]),d.value?(o(),l("div",ie,[t[11]||(t[11]=e("label",{class:"block text-sm mb-1 text-gray-700 dark:text-gray-300"},"Select Users",-1)),g(w(q),{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=a=>p.value=a),options:k.value,mode:"tags",label:"name","track-by":"id","value-prop":"id",placeholder:"Foydalanuvchilarni tanlang",class:"dark:text-gray-100 dark:bg-gray-700"},null,8,["modelValue","options"])])):n("",!0),e("div",ne,[e("button",{onClick:_,class:"px-4 py-2 bg-gray-200 dark:bg-gray-600 dark:text-gray-100 rounded"}," Bekor qilish "),d.value?(o(),l("button",{key:0,onClick:F,class:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded"}," Jo‘natish ")):n("",!0)])])])):n("",!0)]),_:1})]),_:1})],64))}});export{he as default};
