import{d as E,r as d,c as l,o,a as _,u as N,h as j,w as T,b as w,e as t,n as v,t as n,i as V,v as A,f,F as y,g as k,j as D}from"./app-CvWSRHXZ.js";import{_ as U}from"./AppLayout.vue_vue_type_script_setup_true_lang-ukFRSCtx.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Cy0htrRV.js";import"./useForwardExpose-CtqrSHKd.js";import"./VisuallyHidden-Cvv-R-Bg.js";const I={class:"container mx-auto px-4 py-8 max-w-4xl"},P={class:"bg-white rounded-xl shadow-md overflow-hidden p-6"},R={class:"mb-6"},G={class:"mb-8"},K={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"},L=["onClick"],q={class:"mb-8"},H={class:"flex flex-wrap gap-3"},J=["onClick"],O={class:"mb-6"},Q={key:0,class:"flex items-center justify-between p-2 bg-gray-50 rounded"},W={class:"flex items-center"},X={class:"font-medium text-gray-800"},Y={class:"text-xs text-gray-500"},Z={key:1,class:"text-gray-500"},ee={class:"mb-6"},te={class:"file-drop-area p-8 text-center"},se={class:"flex flex-col items-center justify-center"},ie={key:0,class:"mt-4"},le={class:"flex items-center justify-between p-2 bg-gray-50 rounded"},oe={class:"flex items-center"},ae={class:"font-medium text-gray-800"},re={class:"text-xs text-gray-500"},ne=E({__name:"Edit",props:{archive:{},folders:{},categories:{}},setup(C){const a=C,u=d(a.folders.find(s=>s.id===a.archive.folder_id)||null),c=d(a.archive.category_id),x=d(a.archive.name),r=d([]),m=d(""),b=d(!1);function g(s,e=!1){m.value=s,b.value=e,setTimeout(()=>m.value="",5e3)}function F(s){const e=s.target.files;if(e&&e[0]){const i=e[0];if(i.size>20*1024*1024){alert("Fayl hajmi 20 MB dan oshmasligi kerak!");return}r.value=[i]}}function B(){r.value=[]}function M(s){u.value=s}function S(s){c.value=s.id}function h(s){if(s===0)return"0 Bytes";const e=1024,i=["Bytes","KB","MB","GB"],p=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,p)).toFixed(2))+" "+i[p]}async function z(){if(!u.value){alert("Please select a folder");return}if(!c.value){alert("Please select a category");return}const s=new FormData;s.append("folder_id",u.value.id.toString()),s.append("category_id",c.value.toString()),s.append("name",x.value),s.append("_method","PUT"),r.value.length>0&&s.append("file",r.value[0]);try{const e=await D.post(`/archives/${a.archive.id}`,s,{headers:{"Content-Type":"multipart/form-data"}});g("Archive updated successfully!",!1),setTimeout(()=>{window.location.reload()},3e3)}catch(e){e.response&&e.response.status===422?(console.error("Validation errors:",e.response.data.errors),g("Failed to update archive. Check inputs.",!0)):(console.error("Unexpected error:",e),g("Unexpected error occurred.",!0))}}return(s,e)=>(o(),l(y,null,[_(N(j),{title:"Arxivni tahrirlash"}),_(U,null,{default:T(()=>[m.value?(o(),l("div",{key:0,class:v(["fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded shadow-lg z-50 transition",b.value?"bg-red-500 text-white":"bg-green-500 text-white"])},n(m.value),3)):w("",!0),t("div",I,[t("div",P,[e[17]||(e[17]=t("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"Edit Archive",-1)),e[18]||(e[18]=t("p",{class:"text-gray-600 mb-6"},"Change archive info, folder, category or files",-1)),t("div",R,[e[1]||(e[1]=t("label",{class:"block text-gray-700 mb-2"},"Archive Name",-1)),V(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>x.value=i),type:"text",class:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[A,x.value]])]),t("div",G,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-folder-open mr-2 text-indigo-500"}),f(" Select Folder ")],-1)),t("div",K,[(o(!0),l(y,null,k(s.folders,i=>(o(),l("div",{key:i.id,class:v(["folder-item cursor-pointer p-3 border rounded-lg flex items-center",{"border-indigo-500 bg-indigo-50":u.value?.id===i.id}]),onClick:p=>M(i)},[e[2]||(e[2]=t("i",{class:"fas fa-folder mr-3 text-xl text-yellow-500"},null,-1)),t("span",null,n(i.name),1)],10,L))),128))])]),t("div",q,[e[5]||(e[5]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-tags mr-2 text-indigo-500"}),f(" Select Category ")],-1)),t("div",H,[(o(!0),l(y,null,k(s.categories,i=>(o(),l("div",{key:i.id,class:v(["category-pill cursor-pointer px-4 py-2 bg-gray-100 rounded-full flex items-center",{"bg-indigo-100 border border-indigo-300":c.value===i.id}]),onClick:p=>S(i)},[e[4]||(e[4]=t("i",{class:"fas fa-tag mr-2 text-gray-500"},null,-1)),t("span",null,n(i.name),1)],10,J))),128))])]),t("div",O,[e[7]||(e[7]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-file mr-2 text-indigo-500"}),f(" Existing File ")],-1)),a.archive.file?(o(),l("div",Q,[t("div",W,[e[6]||(e[6]=t("i",{class:"fas fa-file text-indigo-500 mr-3"},null,-1)),t("div",null,[t("div",X,n(a.archive.name),1),t("div",Y,n(h(a.archive.file.size)),1)])])])):(o(),l("div",Z,"No file uploaded."))]),t("div",ee,[e[15]||(e[15]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-4 flex items-center"},[t("i",{class:"fas fa-cloud-upload-alt mr-2 text-indigo-500"}),f(" Replace/Add File ")],-1)),t("div",te,[t("div",se,[e[8]||(e[8]=t("i",{class:"fas fa-cloud-upload-alt text-5xl text-indigo-400 mb-4"},null,-1)),e[9]||(e[9]=t("p",{class:"text-gray-600 mb-2"},"Drag & drop a new file here",-1)),e[10]||(e[10]=t("p",{class:"text-gray-500 text-sm mb-4"},"or",-1)),e[11]||(e[11]=t("label",{for:"fileInput",class:"cursor-pointer px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition"}," Browse File ",-1)),t("input",{type:"file",id:"fileInput",class:"hidden",onChange:F},null,32)])]),r.value.length>0?(o(),l("div",ie,[e[14]||(e[14]=t("h3",{class:"font-medium text-gray-700 mb-2"},"Selected File:",-1)),t("div",le,[t("div",oe,[e[12]||(e[12]=t("i",{class:"fas fa-file text-indigo-500 mr-3"},null,-1)),t("div",null,[t("div",ae,n(r.value[0].name),1),t("div",re,n(h(r.value[0].size)),1)])]),t("button",{onClick:B,type:"button",class:"text-red-500 hover:text-red-700"},e[13]||(e[13]=[t("i",{class:"fas fa-times"},null,-1)]))])])):w("",!0)]),t("div",{class:"mt-4 flex justify-end"},[t("button",{type:"button",onClick:z,class:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition flex items-center"},e[16]||(e[16]=[t("i",{class:"fas fa-save mr-2"},null,-1),f(" Save Changes ",-1)]))])])])]),_:1})],64))}}),xe=$(ne,[["__scopeId","data-v-98b00f3f"]]);export{xe as default};
